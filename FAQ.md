# Вопросы / Ответы

## Почему оригинальная macOS не торт?

Есть целый ряд причин, по которым осуществляется попытка реализовать Poppy вместо того, чтобы просто поставить macOS...

### Коммерциализация

Без Apple ID невозможен доступ ко всем ключевым сервисам Apple (App Store, Xcode, iTunes, iCloud) - система превращается в наполовину заблокированную оболочку. Однако использование Apple ID нередко сопровождается искусственными неудобствами: двухфакторная авторизация обязательна, но коды подтверждения могут не приходить часами или даже днями; восстановление доступа к учётной записи занимает недели, а поддержка зачастую лишь предлагает подождать. При этом сам Apple ID жёстко привязан к устройству - если удалить аккаунт, не отвязав его заранее, можно получить полностью заблокированное устройство, и служба поддержки в таких случаях, как правило, умывает руки. Единая система идентификации, задуманная как элемент безопасности и удобства, на деле превращается в инструмент контроля, от которого невозможно отказаться, не потеряв доступ к самому macOS.

Эта же зависимость проявляется и в работе фирменных сервисов. iTunes давно перестал быть просто медиакомбайном: это тщательно выстроенный механизм вовлечения, где вся логика взаимодействия крутится вокруг iPhone и iPad. Пользователи macOS не получают никакой официальной поддержки для синхронизации с Android-устройствами - ни платной, ни бесплатной. Даже простая передача музыки или резервных копий становится невозможной без покупки контента или без привязки к устройствам Apple. Похожим образом устроен и iCloud - позиционируемый как неотъемлемая часть macOS, он заменяет локальное хранение и навязывает облачное, однако бесплатные 5 ГБ выглядят символически (особенно на фоне конкурентов вроде MEGA, где стартовый объём в четыре раза больше), при этом тарифы на расширение хранилища ощутимо выше рыночных. В свою очередь альтернативные сервисы на macOS нередко работают ограниченно или интегрируются заметно хуже.

### Пользователь не владеет ОС

В macOS пользователь номинально обладает правами администратора, но фактически управляет лишь поверхностным уровнем системы. Даже базовые операции - удаление встроенных приложений вроде Safari, Mail или Photos - невозможны без обходных манипуляций. Попытка изменить системные шрифты, темы или загрузочные экраны встречает сопротивление SIP (System Integrity Protection) и sandbox-защиты, которая блокирует доступ не только к системным файлам, но и к множеству конфигурационных каталогов. Apple позиционирует это как "security", но точнее было бы сказать "security through obscurity", т.к. компания превращает macOS в закрытый чёрный ящик, где пользователю запрещено даже видеть, что реально происходит под капотом.

Для сравнения, в Windows подобные ограничения есть, но они не столь жёсткие. Microsoft тоже защищает системные файлы и компоненты, однако при желании администратор может изменить почти любой аспект системы - от загрузочных параметров до внешнего вида интерфейса. На macOS же даже изменение иконок требует неофициальных патчей или утилит, которые перестают работать после каждого обновления. Система не терпит чужих решений - многие расширения и твики блокируются автоматически, а разработчикам таких инструментов Apple просто закрывает доступ к API. Так, например, после обновления до macOS Ventura перестали работать десятки утилит, добавлявших функциональность вроде расширенного Dock, настраиваемых жестов трекпада или интеграции с облаками вне iCloud...

### Ограниченная поддержка оборудования

Ограничение macOS только техникой Apple - не просто маркетинговый ход, а часть стратегии замыкания экосистемы. Даже устройства, которые аппаратно полностью совместимы с macOS, не имеют официальной поддержки. Так, ноутбук с тем же чипом Wi-Fi, что и в MacBook, может оказаться "неподдерживаемым", потому что драйвер Apple имеет проверку серийного номера материнской платы. Пользователи вынуждены искать сторонние kext'ы (драйверы ядра), патчить загрузчик OpenCore и вручную маскировать устройство под настоящий Mac, чтобы система вообще запустилась. В результате любая установка превращается в квест, где очередное обновление может обрушить всё окружение.

Более того, Apple активно сокращает поддержку даже собственной техники. Модель 2015 года может перестать получать обновления безопасности уже через 7-8 лет, несмотря на то, что физически она способна работать десятилетие и более. Пользователь вынужден либо оставаться на старой, потенциально уязвимой системе, либо покупать новое устройство - потому что macOS просто откажется ставиться на старое. При этом, в отличие от Windows или Linux, официального механизма обновления драйверов вручную не существует: Apple не публикует их отдельно. Философия "it just works" превращается в "it just stops working".

### Нестандартные горячие клавиши и раскладки

Система ввода macOS живёт в своём мире. Клавиша ⌘ (Command), которая заменяет привычный Ctrl, ломает мышечную память всех, кто работает в смешанной среде Windows/Linux. Даже базовые сочетания вроде копирования и вставки могут вызывать путаницу на обычных клавиатурах: Command физически находится на месте Alt, а Option выполняет функции AltGr, но с контекстными отличиями. Более того, некоторые комбинации просто отсутствуют: например, нет стандартного аналога Ctrl+Alt+Del для быстрого управления процессами. Приходится открывать Activity Monitor вручную или через Spotlight.

Отдельная история - раскладки. Apple использует свои версии даже для международных стандартов, и многие символы находятся не там, где их ожидаешь. Например, тире и подчёркивание на внешней клавиатуре PC могут требовать сочетания с Option, а квадратные скобки и бэктик оказываются на других рядах. Программистам, работающим с кодом, приходится либо переназначать клавиши через сторонние утилиты вроде Karabiner, либо мириться с постоянным дискомфортом. Проблема усугубляется тем, что macOS ограничивает настройку раскладок на уровне системы - невозможно просто создать пользовательскую, как это делается в Linux. Даже переключение языка требует отдельного сочетания клавиш, отличного от общепринятого Alt+Shift.

### Изменения ради изменений

Apple известна тем, что без колебаний меняет направление развития macOS, не оглядываясь на обратную совместимость. История переходов говорит сама за себя: от Motorola к PowerPC, затем к Intel, теперь к ARM - и каждый раз пользователи теряли совместимость с десятками программ. Например, после перехода на Apple Silicon прекратила работу масса приложений без поддержки Rosetta 2, а разработчикам пришлось перекомпилировать всё под новую архитектуру. При этом Apple через 2-3 года просто выключает поддержку старого переходного слоя, оставляя пользователей и разработчиков один на один с несовместимостью.

То же происходит и на уровне интерфейса. Едва привыкнув к одной эстетике, пользователи сталкиваются с очередной "революцией дизайна": от объёмной Aqua с глянцевыми кнопками к плоскому минимализму, затем к гибридному неоморфизму, а теперь - к полупрозрачным панелям Liquid Glass. Каждая такая итерация ломает привычные паттерны и заставляет приложения выглядеть устаревшими. Старые API (Carbon, QuickDraw, OpenGL) заменяются новыми (Cocoa, Metal) без длительного переходного периода, а документация часто обрывается на середине. Разработчики вынуждены постоянно переписывать приложения, чтобы те просто запускались, а пользователи получают систему, где одна половина утилит ещё не обновилась, другая же - никогда больше не заработает.

## Почему не pearOS, helloSystem, ravynOS, GnuStep..?

Poppy строится как ультимативное решение, покрывающее и системный уровень, и пользовательскую среду, ценой осознанного и взвешенного отказа от совместимости с большей частью существующего прикладного ПО (только на первых порах развития), в то время как:

- pearOS и helloSystem фокусируются преимущественно на поверхностной имитации интерфейса или заимствовании некоторых аспектов работы с macOS.
- ravynOS пытается добиться одновременно и визуальной и бинарной совместимости с macOS, но лишь на голом энтузиазме.
- GnuStep предлагает устаревшую реализацию Cocoa-подобных библиотек без непосредственно системной базы и пользовательского окружения.

## Почему дизайн OS X 10.9, а не [что угодно]?

Poppy с самого своего начала консервативно ориентируется на последнюю скевоморфичную версию OS X как на околоидеальный UX, где особенно значимыми считаются:
- Глобальная строка меню - удобный и элегантный способ доступа к служебной части приложений, рационально использующий место на экране.
- Finder, Dock, Launchpad и Mission Control - давно зарекомендовавшие себя решения, где каждый элемент на своём месте (ну, почти).
- Единый графический фреймворк - общие стиль и способ разработки/взаимодействия со всеми приложениями.
- Простейший способ организации файловой структуры, позволяющий:
	- Чётко видеть где и что находится, с учётом трёх доменов (пользовательский, локальный и системный), не используя строку поиска.
	- Устанавливать или удалять фреймворки, приложения и плагины одной самодостаточной папкой (иногда нескольких, совсем редко через специализированный установщик).
	- Нормальную работу POSIX-программ, ввиду _скрытой от рядового пользователя_ совместимости с FHS на низком уровне.
- Досконально прорисованные и метрически выверенные элементы интерфейса - визуальный отклик, что дизайнеры не зря свой хлеб ели.
- Приятные глазу анимации и эффекты композиции - не больше и не меньше, чем нужно.
- Высокоуровневый и низкоуровневый интерфейсы - возможность выбора для системных разработчиков и продвинутых пользователей.

## Почему не DE и не оболочка, а "ОС с оверлейным ядром"?

Poppy практически не полагается на существующую системную архитектуру и не выступает только лишь средством доступа к ней, как предполагается терминами "окружение рабочего стола" и "оболочка", а вводит собственную замену там, где это целесообразно. Даже если бы использовалась привычная терминология, и Poppy OS формально определялась как "оболочка с функциями ОС", это навсегда бы поставило точку в вопросе её возможного перехода из разряда частично-хосто-зависимых (внешнее 0K) в хосто-независимые (интегрированное 0K), что является идеологическим противоречием при общем ориентировании на самодостаточность. В свою очередь, термин "операционная система" в классическом понимании подразумевает монолит, контролирующий всё оборудование напрямую. Но в эпоху виртуализации, контейнеров и гипервизоров это определение устарело: даже Linux, запущенный внутри Docker или WSL, уже не контролирует железо напрямую. Poppy честно отражает эту реальность: она - ОС поверх другой ОС, и потому нуждается в новом языке описания.

Кроме закрытия всех неточностей, контекстная терминология позволяет полностью сконцентрироваться на экспериментальной идее оверлейного ядра. На данный момент считается, что оно способно:
- Использовать UNIX-подобное ядро только как базового исполнителя, примерно аналогично тому, как это делают User-Mode Linux, LibOS, Chromium в ChromeOS и Smalltalk VM.
- Создавать новое, изолированное пространство, для системных вызовов, процессов, файловых систем, политик (всё из этого опционально)...
- Естественным образом сохранять совместимость с существующими драйверами, тем самым и обеспечивая жизнеспособность ОС, и снимая целый пласт повторной работы с его разработчика.
- Быть написанным на языке высокого уровня с использованием всех его возможностей, включая объектно-ориентированные принципы, рефлексию и безопасность тестирования/отладки.

## Почему не Qt / GTK, KWin / Mutter, SDDM / GDM..?

Poppy не использует существующие решения из графического стека FreeBSD / Linux, потому что это противоречит идее вдумчивого воссоздания архитектуры и системной модели OS X, где графическая подсистема, менеджер окон, композитор и окружение пользователя не существуют как набор независимых процессов, а являются частями единой среды.

Qt, KWin, SDDM и другие подобные решения исходно спроектированы для пользовательского пространства Linux и подчиняются его разрозненной IPC-модели (POSIX, Wayland, D-Bus). Это можно сравнить с портированием всего вышеперечисленного на macOS - даже при глубокой модификации такие фреймворки всё равно бы остались гостями в чужой архитектуре, а не её основой.

## Почему не Snap, FlatPak, AppImage, пакетные менеджеры..?

Poppy не признаёт **архивные** и/или **изолированные** bundle'ы как способ распространения фреймворков или приложений по той причине, что нет смысла изобретать велосипед. NextStep уже давно решил эту проблему идеальным способом, не сломав совместимость с привычным (на данный момент) UX. Степень изоляции в Snap или FlatPak часто ломает или не учитывает нативную интеграцию с ОС и возводит самодостаточность в абсолют, пакеты становятся сложными в использовании и весомыми физически. AppImage также требует системной службы для относительно нормальной интеграции, и сложнее по части модифицирования ресурсов пакета пользователем. Обязательная процедура монтирования пакетов в общем случае делает их недоступными для низкоуровневого системного программирования, а "установка" как противоположность "запуска" из любого места заставляет пользователя совершать лишние действия, тратя больше времени на решение искусственных ограничений вместо работы.

Пакетные менеджеры и репозитории считаются таким же пережитком эпохи UNIX, как и интерфейс на базе командной строки, когда общее количество файлов (библиотек и программ) в системе часто было очень маленьким и делилось между обратно-пропроционально большим количеством технически подкованных пользователей одного сервера в одном институте. Современный пользователь не хочет лезть в командную строку и разбираться с подключением репозиториев, если только он не заядлый юниксоид - такова правда жизни, которая медленно, но верно, доходит до разработчиков desktop'но-ориентированных дистрибутивов Linux, и пока ещё совсем не доходит до консерваторов. С Linux ситуация также осложняется количеством существующего ПО, которое необходимо поддерживать, чтобы не потерять и без того малую долю пользователей на рынке - однако, это не вопрос для Poppy. Здесь важна не совместимость любой ценой, а внутренне непротиворечивая экосистема. Всё, что нарушает её целостность - отсекается.

## Почему Poppy? (TL;DR)

Poppy возникла как попытка создать личную альтернативу macOS, но без ограничений, которые делает её проприетарной и закрытой. Это не "ещё один дистрибутив" и не "копия интерфейса", а способ реализовать настольную систему, в которой эстетика и архитектура ранней OS X сочетаются с доступной каждому, эффективной моделью разработки.

Вместо того чтобы писать классическое ядро с нуля - что потребовало бы многолетней работы и команды разработчиков, Poppy строится как оверлейная ОС: она использует существующие, достаточно гибкие открытые ядра как хост, и создаёт поверх них собственный системный слой. В отличие от SerenityOS, которая полностью автономна, и ReactOS, которая стремится к бинарной совместимости, Poppy ищет баланс между возможным и идеальным.

Сама идеология проекта исходит из желания воссоздать "правильную" настольную ОС, где всё - от графики до системных API, подчинено единому замыслу: повторить дух OS X 10.9, сохранить прозрачность и редактируемость системных уровней, добавить понятную декларативную модель безопасности для пользователей и интерпретируемую среду для приложений. Это проект о том, какой могла бы быть macOS, если бы она оставалась открытой, расширяемой и подконтрольной.

Т.к. Poppy OS пытается сочитать экспериментальную природу с понятием "просто работает", в идеале целевая аудитория довольно обширна:
- Разработчики, которым нужна прозрачная, предсказуемая и редактируемая система, не ограничивающая эксперименты с низкоуровневыми слоями.
- Дизайнеры или продвинутые пользователи, ценящие цельность визуальной среды и последовательность интерфейсов.
- Исследователи систем, которым важно иметь реальную, но безопасную площадку для тестирования идей.
- И просто люди, которые хотят стабильную, красивую, но открытую систему - такую, где всё можно понять, изменить и вернуть обратно...